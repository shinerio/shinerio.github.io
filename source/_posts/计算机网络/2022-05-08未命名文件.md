---
title: 云网络架构发展
categories:
- 云计算
tags:
- 云计算
- 网络
---
## 1. 基本概念

## 1.1 Global区域划分

- **Region**：数据中心的物理位置，同一个Region内共享弹性计算、块存储、对象存储、VPC网络、弹性公网IP、镜像等公共服务，其目的是为了用户能就近接入，降低网络延迟。通常是一个城市的若干个AZ组成一个region，例如aws就有US East(N. Virginia)、US East(Ohio)、US West(N. California)、US West(Oregon)等。Region满足用户到最近的网络时延不大于100ms，region内的网络时延1-10ms。
- **AZ**，即Availability Zone，一个AZ是一个或多个物理数据中心的集合，有独立的风火水电，AZ内逻辑上再将计算、网络、存储等资源划分成多个集群。一个Region中的多个AZ间通过高速光纤相连，以满足用户跨AZ构建容灾高可用性系统的需求。AZ内的网络时延一般小于1ms。
- **Local zone**：本地站点或边缘站点。通常云服务厂商会在大型或超大型城市附近建立数据中心，用户可以以较低的时延接入这些中心。但是一些二三线、甚至四五线城市可能距离这些region有一定距离，而时延敏感型客户可能更希望能直接在local接入云服务。因此，云服务厂商根据客户需求在一些小型城市构建local zone，通过骨干网与中心region互联，以实现云服务的就近部署，面向local本地终端用户提供更低时延的服务。

<!--more-->

## 1.2 单Region分区

- **POP**, 即point-of-presence，一般一个城市群或有多个region，但只会有两个pop点，每个region都与两个pop点互联。POP点通过静态BGP或动态BGP接入多家网络运营商（联通、电信、移动）。在计算机网络中，pop表示入网点（pop），pop位于网络企业的边缘外侧，是访问企业网络内部的进入点，外界提供的服务通过pop进入，这些服务包括Internet接入，广域连接以及电话服务（PSTN）。
- **Transit Zone**：Transit zone作为DCN网络的边界，上线对接广域网，下行对接AZ用来分流，一般会部署2个独立的transit区以提供容灾能力。Transit区的选址一般选在region“中间位置“，尽可能距离所有AZ和POP点距离最近的地方。在Transit zone可以部署边界网关、专线网关、VPN网关等来分别接入公网流量，专线流量、VPN流量等。此外Transit zone通常会部署防火墙，用以进行QOS限速，DDOS防御等。 
- **DMZ**，即demilitarized zone。一般云计算中心都会将网络环境分为外网环境和内网环境，外网环境一般是不可信任区，而内网环境一般是可信任区，外部网络一般是不允许直接访问内部网络的，因此两者之间一般会加装防火墙。DMZ就是内部网络和外部网络之间的缓冲区，在这个区域我们可以部署API网关，通过反向代理的能力提供一些必须面向互联网公网的服务。
- **NSZ**，即Network Service Zone。网络服务区，部署网络服务的区域，如弹性负载均衡(ELB)、NAT网关(Nat Gateway)、终端服务（Endpoint Servie），提供更加多元化的网络的服务。
- **PSZ**，即Public Service Zone。公共服务区，一般所有的管理面组件、中间件等都部署在这个区域，面向云服务用户提供API服务。
- **OMZ**，及Operation Manage zone。运维面，部署运维组件，负责云服务组件监控和生命周期管理。
- **POD**，point of delivery，是一个基本的物理交付单元。一个POD包括网络、计算、存储和应用等组成部分共同工作来提供网络服务的模块。PoD是一个模块化设计的概念，最大限度地提高了数据中心的模块化、可拓展性和可管理性。一般计算节点就部署在这个服务，提供弹性计算服务（ECS）。

![enter description here](https://raw.githubusercontent.com/shinerio/shinerio.github.io/blog-images/小书匠/1652007438377.png)
## 1.3 N朵云

- **公有云**：公有云是最常见的云计算部署类型，面向最广大的使用用户提供服务。公有云资源（例如服务器和存储空间）由第三方云服务提供商拥有和运营，这些资源通过 Internet 提供。在公有云中，所有硬件、软件和其他支持性基础结构均为云提供商所拥有和管理。
- **私有云**：私有云由专供一个企业或组织使用的云计算资源构成。私有云可在物理上位于企业的IDC机房，也可由第三方服务提供商托管。但是，在私有云中，服务和基础结构始终在私有网络上进行维护，硬件和软件专供特定企业使用。私有云的使用对象通常为政府机构、金融机构以及其他具备业务关键性运营且希望对环境拥有更大控制权的中型到大型企业。
- **混合云**：混合云是将私有云与公有云结合在一起。使用混合云，可以在两种环境之间移动数据和应用。通过专线将公有云和线下私有连接起来，融合成一个大云。
- **合营云**：一家云服务厂商提供IT技术支持，而云服务的资产权和运营权都有另一家云服务厂商拥有，两者按照一定比列分成。
- **政务云**：私有云的一种特殊形态，专指为政企事业单位构筑的私有云。
- **边缘云**：在一些中小型城市构建小型化数据化中心，提供就近边缘访问。

# 2. 物理网络演进
## 2.1 传统三层网络

参考[数据中心网络架构](https://shinerio.cc/2020/05/02/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84/)

## 2.2 大二层架构

参考[数据中心网络架构](https://shinerio.cc/2020/05/02/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84/)

## 2.3 新三层网络

大二层架构下，transit区和NSZ共处一个二层网络。存在以下问题：

1. 故障域不隔离，全region故障风险大
2. 二层广播风暴故障，容易导致整个region故障
3. 扩容网关、新建AZ等，都需要和存量网络打通二层隧道，操作复杂，容易引发事故。

三层网络最大的问题在于虚机跨POD HA需要换ip地址和网关，这对于弹性的影响是非常大的。因此三层网络下将租户平面通过VRF划分，租户平面仍然是个二层环境。

## 2.4 POD下沉

前几代网络架构对于分区的调整其实并不大。NSZ部署的各种网络都是物理机形态，弹性和容灾能力都很差。POD下沉方案将NSZ部署的物理网关下沉的POD区。网关节点以ECS的形式存在，可实现真正的弹性扩容。

# 3. 虚拟网络
## 3.1 VLAN
![enter description here](https://raw.githubusercontent.com/shinerio/shinerio.github.io/blog-images/小书匠/1652008768056.png)


## 3.2 VXLAN和VXLAN-GPE
![enter description here](https://raw.githubusercontent.com/shinerio/shinerio.github.io/blog-images/小书匠/1652008892106.png)


# 4. 管理面演进

openstack

## 4.1 级联架构

## 4.4 单层架构

## 4.5 微服务架构
