<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no">
    <title>Subagents - Shinerio's Blog</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./assets/css/style.css">
    <meta property="og:title" content="Subagents">
<meta property="og:description" content="1. å­ä»£ç†æ˜¯ä¸“é—¨å¤„ç†ç‰¹å®šç±»å‹ä»»åŠ¡çš„ AI åŠ©æ‰‹ï¼Œå½“Claudeé‡åˆ°ä¸å­ä»£ç†æè¿°ç›¸åŒ¹é…çš„ä»»åŠ¡æ—¶ï¼Œå®ƒä¼šå°†ä»»åŠ¡å§”æ´¾ç»™è¯¥å­ä»£ç†ï¼Œç”±å…¶ç‹¬ç«‹å·¥ä½œå¹¶è¿”å›ç»“æœã€‚ - æ¯ä¸ªå­ä»£ç†éƒ½åœ¨è‡ªå·±çš„ä¸Šä¸‹æ–‡çª—å£ä¸­è¿è¡Œ - æ‹¥æœ‰è‡ªå®šä¹‰çš„ç³»ç»Ÿæç¤ºè¯ï¼ˆSystem Promptï¼‰ - ç‰¹å®šçš„å·¥å…·è®¿é—®æƒé™å’Œç‹¬ç«‹çš„æƒé™è®¾ç½®ã€‚ ä¼˜åŠ¿ï¼š -...">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2026-02-11T11:40:40.204Z">
<meta property="article:author" content="shinerio">
<link rel="stylesheet" id="hljs-light" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
<link rel="stylesheet" id="hljs-dark" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" disabled>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" defer></script>
<script src="assets/js/code-enhance.js" defer></script>
</head>
<body class="article-page" id="theme-body">
    <div class="page-wrapper">
        <div class="sidebar-overlay"></div>
        <header class="page-header">
            <div class="container">
                <nav class="page-nav">
                    <div class="nav-links">
                        <button class="sidebar-toggle" aria-label="Toggle sidebar">
                            <span class="sidebar-toggle-icon"></span>
                        </button>
                        <a href="index.html" class="nav-link ">Home</a>
                        <a href="articles.html" class="nav-link ">Articles</a>
                        <a href="search.html" class="nav-link ">Search</a>
                        <a href="todo.html" class="nav-link ">TODO</a>
                    </div>
                    <div class="nav-actions">
                        <button id="theme-toggle" aria-label="Toggle dark mode" class="theme-toggle-btn">
                            <span class="sun-icon">â˜€ï¸</span>
                            <span class="moon-icon">ğŸŒ™</span>
                        </button>
                    </div>
                </nav>
            </div>
        </header>
        <main class="page-main">
            <div class="container">
                <article>
    <header>
        <h1>Subagents</h1>
        <time datetime="2026-02-11T11:40:40.204Z">2026å¹´2æœˆ11æ—¥</time>
        <div class="tags">
            
        </div>
    </header>
    <section class="content">
        <h1>1. <a href="https://code.claude.com/docs/en/sub-agents">Definition</a></h1>
<p>å­ä»£ç†æ˜¯ä¸“é—¨å¤„ç†ç‰¹å®šç±»å‹ä»»åŠ¡çš„ AI åŠ©æ‰‹ï¼Œå½“Claudeé‡åˆ°ä¸å­ä»£ç†æè¿°ç›¸åŒ¹é…çš„ä»»åŠ¡æ—¶ï¼Œå®ƒä¼šå°†ä»»åŠ¡å§”æ´¾ç»™è¯¥å­ä»£ç†ï¼Œç”±å…¶ç‹¬ç«‹å·¥ä½œå¹¶è¿”å›ç»“æœã€‚</p>
<ul>
<li>æ¯ä¸ªå­ä»£ç†éƒ½åœ¨è‡ªå·±çš„ä¸Šä¸‹æ–‡çª—å£ä¸­è¿è¡Œ</li>
<li>æ‹¥æœ‰è‡ªå®šä¹‰çš„ç³»ç»Ÿæç¤ºè¯ï¼ˆSystem Promptï¼‰</li>
<li>ç‰¹å®šçš„å·¥å…·è®¿é—®æƒé™å’Œç‹¬ç«‹çš„æƒé™è®¾ç½®ã€‚<br><strong>ä¼˜åŠ¿ï¼š</strong></li>
<li><strong>ä¿æŒä¸Šä¸‹æ–‡ï¼š</strong> å­agentå¯¹è¯çš„ç»†èŠ‚å’Œä¸»å¯¹è¯ä¿æŒç‹¬ç«‹ã€‚ </li>
<li><strong>å¼ºåˆ¶çº¦æŸï¼š</strong> é™åˆ¶å­ä»£ç†åªèƒ½ä½¿ç”¨ç‰¹å®šå·¥å…·ã€‚</li>
<li><strong>è·¨é¡¹ç›®å¤ç”¨ï¼š</strong> é€šè¿‡ç”¨æˆ·çº§å­ä»£ç†åœ¨ä¸åŒé¡¹ç›®é—´å…±ç”¨é…ç½®ã€‚</li>
<li><strong>ä¸“ä¸šåŒ–è¡Œä¸ºï¼š</strong> ä¸ºç‰¹å®šé¢†åŸŸä½¿ç”¨ä¸“æ³¨çš„ç³»ç»Ÿæç¤ºè¯ã€‚</li>
<li><strong>æ§åˆ¶æˆæœ¬ï¼š</strong> å°†ä»»åŠ¡è·¯ç”±åˆ°æ›´å¿«ã€æ›´ä¾¿å®œçš„æ¨¡å‹ï¼ˆå¦‚ Haikuï¼‰ã€‚</li>
</ul>
<h1>2. å§”æ‰˜æ–¹å¼</h1>
<p>Claude uses each <strong>subagentâ€™s description</strong> to decide when to delegate tasks. When you create a subagent, write a clear description so Claude knows when to use it.</p>
<h1>3. å†…ç½®å­ä»£ç†</h1>
<table>
<thead>
<tr>
<th>Agent</th>
<th>Model</th>
<th>Tool</th>
<th>When Claude uses it</th>
</tr>
</thead>
<tbody><tr>
<td>Plan</td>
<td>Inherits</td>
<td>Read-only tools</td>
<td>Plan mode: Codebase research for planning</td>
</tr>
<tr>
<td>Explore</td>
<td>Haiku</td>
<td>Read-only tools</td>
<td>File discovery, code search, codebase exploration</td>
</tr>
<tr>
<td>General-purpose</td>
<td>Inherits</td>
<td>All tools</td>
<td>Complex research, multi-step operations, code modifications</td>
</tr>
<tr>
<td>Bash</td>
<td>Inherits</td>
<td></td>
<td>Running terminal commands in a separate context</td>
</tr>
<tr>
<td>statusline-setup</td>
<td>Sonnet</td>
<td></td>
<td>When you runÂ <code>/statusline</code>Â to configure your status line</td>
</tr>
<tr>
<td>Claude Code Guide</td>
<td>Haiku</td>
<td></td>
<td>When you ask questions about Claude Code features</td>
</tr>
</tbody></table>
<h1>4. è‡ªå®šä¹‰agents</h1>
<h2>é…ç½®æ–‡ä»¶ç¤ºä¾‹<br>```markdown</h2>
<h2>name: test-case-executor<br>description: &quot;Use this agent when you need to execute test cases and analyze failures without making any modifications to the code. This agent should be invoked when test results show failures and you need to understand why tests are failing. Examples of usage include:\n\n<example>\nContext: The user wants to run existing tests to verify functionality\nuser: &quot;Please execute the test suite and tell me which tests fail and why&quot;\nassistant: &quot;I&#39;ll use the test-case-executor agent to run the tests and analyze any failures&quot;\n</example>\n\n<example>\nContext: Test execution shows failing tests that need analysis\nuser: &quot;The build failed with test errors, can you help me understand why?&quot;\nassistant: &quot;Let me use the test-case-executor agent to run the tests and analyze the failure reasons&quot;\n</example>&quot;<br>tools: Glob, Grep, Read, WebFetch, WebSearch, ListMcpResourcesTool, ReadMcpResourceTool<br>model: inherit<br>color: green</h2>
<p>You are an expert test case execution and analysis specialist. Your role is to execute test cases and provide detailed analysis of why tests fail, without making any modifications to the code.</p>
<p>Your responsibilities:</p>
<ul>
<li>Execute the provided test cases or test suite in the current environment</li>
<li>Carefully observe and record all test results, including passed, failed, and skipped tests</li>
<li>For each failed test, provide a comprehensive analysis of the root cause</li>
<li>Identify specific issues such as assertion failures, exceptions, incorrect values, performance problems, or missing dependencies</li>
<li>Explain the technical reasons behind each failure with reference to the expected vs actual behavior</li>
<li>Highlight any environmental factors that might contribute to test failures</li>
<li>Provide suggestions for potential fixes while emphasizing that you cannot implement them yourself</li>
<li>If tests pass successfully, confirm that execution completed without issues</li>
</ul>
<p>Constraints:</p>
<ul>
<li>You are strictly prohibited from modifying any code, files, or configurations</li>
<li>Only perform analysis and reporting functions</li>
<li>Do not attempt to fix, update, or change any implementation</li>
<li>Focus solely on providing insights about test execution and failure analysis</li>
</ul>
<p>Output Format:</p>
<ul>
<li>Summary of total tests executed, passed, failed, and skipped</li>
<li>Detailed breakdown of each failed test with specific failure causes</li>
<li>Technical explanation of why each failure occurred</li>
<li>Relevant stack traces or error messages that explain the failures</li>
<li>Any patterns or commonalities among failing tests</li>
</ul>
<pre><code>
## 4.1. é…ç½®æ–‡ä»¶æ ¼å¼**
å­ä»£ç†å®šä¹‰åœ¨å¸¦æœ‰ YAML å‰æ³¨ï¼ˆFrontmatterï¼‰çš„ Markdown æ–‡ä»¶ä¸­ï¼š
```Markdown
name: test-case-executor
description: &quot;Use this agent when you need to execute test cases and analyze failures without making any modifications to the code. This agent should be invoked when test results show failures and you need to understand why tests are failing. Examples of usage include:\\n\\n&lt;example&gt;\\nContext: The user wants to run existing tests to verify functionality\\nuser: \&quot;Please execute the test suite and tell me which tests fail and why\&quot;\\nassistant: \&quot;I&#39;ll use the test-case-executor agent to run the tests and analyze any failures\&quot;\\n&lt;/example&gt;\\n\\n&lt;example&gt;\\nContext: Test execution shows failing tests that need analysis\\nuser: \&quot;The build failed with test errors, can you help me understand why?\&quot;\\nassistant: \&quot;Let me use the test-case-executor agent to run the tests and analyze the failure reasons\&quot;\\n&lt;/example&gt;&quot;
tools: Glob, Grep, Read, WebFetch, WebSearch, ListMcpResourcesTool, ReadMcpResourceTool
model: inherit
color: green
</code></pre>
<p><strong>æ”¯æŒçš„å­—æ®µï¼š</strong></p>
<ul>
<li><code>name</code>: å”¯ä¸€æ ‡è¯†ç¬¦ã€‚</li>
<li><code>description</code>: <strong>å…³é”®å­—æ®µ</strong>ï¼ŒClaude æ ¹æ®æ­¤æè¿°å†³å®šä½•æ—¶å§”æ´¾ä»»åŠ¡ã€‚</li>
<li><code>tools</code> / <code>disallowedTools</code>: å…è®¸æˆ–ç¦æ­¢ä½¿ç”¨çš„å·¥å…·æ¸…å•ã€‚</li>
<li><code>model</code>: æŒ‡å®šæ¨¡å‹ï¼ˆsonnet, opus, haiku æˆ– inheritï¼‰ã€‚</li>
<li><code>permissionMode</code>: æƒé™æ¨¡å¼ï¼ˆå¦‚ <code>dontAsk</code> è‡ªåŠ¨åŒæ„ï¼Œæˆ– <code>plan</code> ä»…é™è®¡åˆ’ï¼‰ã€‚</li>
<li><code>memory</code>: å¯ç”¨è·¨ä¼šè¯çš„æŒä¹…è®°å¿†ã€‚</li>
</ul>
<h2>4.2. å‰å°ä¸åå°è¿è¡Œ**</h2>
<ul>
<li><strong>åå°è¿è¡Œï¼š</strong> å­ä»£ç†å¯ä»¥åœ¨åå°é™é»˜å·¥ä½œï¼Œä¸æ‰“æ–­ä½ çš„å½“å‰å¯¹è¯ã€‚Claude ä¼šè‡ªåŠ¨å†³å®šä½•æ—¶åå°è¿è¡Œï¼Œä½ ä¹Ÿå¯ä»¥è¦æ±‚ &quot;run this in the background&quot; æˆ–æŒ‰ <code>Ctrl+B</code>ã€‚</li>
<li>æ³¨æ„ï¼šåå°å­ä»£ç†å¦‚æœéœ€è¦é¢å¤–æƒé™ï¼Œå·¥å…·è°ƒç”¨ä¼šå¤±è´¥ï¼Œä½ å¯ä»¥åœ¨å‰å°æ¢å¤ï¼ˆResumeï¼‰å®ƒä»¥è¿›è¡Œäº¤äº’ã€‚<br><img src="https://shinerio.oss-cn-beijing.aliyuncs.com/obsidian/20260211203944383.png" alt="image.png"></li>
</ul>

    </section>
</article>


<section class="comments-section" id="comments">
    <h2 class="comments-title">è¯„è®º</h2>
    <div class="utterances-container">
        <script src="https://utteranc.es/client.js"
        repo="shinerio/shinerio.github.io"
        issue-term="Subagents"
        label="blog-comment"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>
    </div>
</section>
            </div>
        </main>
        <footer class="page-footer">
            <div class="container">
                <p>&copy; 2026 shinerio. All rights reserved.</p>
            </div>
        </footer>
    </div>

    <script>
        // Theme switching functionality
        document.addEventListener('DOMContentLoaded', function() {
            const themeToggle = document.getElementById('theme-toggle');
            const body = document.getElementById('theme-body');

            // Check for saved theme preference or respect OS preference
            const savedTheme = localStorage.getItem('theme');
            const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');

            // Set initial theme
            if (savedTheme === 'dark' || (!savedTheme && prefersDarkScheme.matches)) {
                body.setAttribute('data-theme', 'dark');
            } else {
                body.removeAttribute('data-theme'); // light theme
            }

            // Sync Utterances iframe theme
            function syncUtterancesTheme(isDark) {
                const utterancesFrame = document.querySelector('.utterances-frame');
                if (utterancesFrame) {
                    const theme = isDark ? 'github-dark' : 'github-light';
                    utterancesFrame.contentWindow.postMessage(
                        { type: 'set-theme', theme: theme },
                        'https://utteranc.es'
                    );
                }
            }

            // Listen for Utterances iframe ready to set initial theme
            window.addEventListener('message', function(event) {
                if (event.origin !== 'https://utteranc.es') return;
                const isDark = body.getAttribute('data-theme') === 'dark' ||
                    (!localStorage.getItem('theme') && prefersDarkScheme.matches);
                syncUtterancesTheme(isDark);
            });

            // Toggle theme function
            function toggleTheme() {
                if (body.getAttribute('data-theme') === 'dark') {
                    body.removeAttribute('data-theme');
                    localStorage.setItem('theme', 'light');
                    syncUtterancesTheme(false);
                } else {
                    body.setAttribute('data-theme', 'dark');
                    localStorage.setItem('theme', 'dark');
                    syncUtterancesTheme(true);
                }
            }

            // Add event listener to theme toggle button
            themeToggle.addEventListener('click', toggleTheme);

            // Listen for OS theme changes
            prefersDarkScheme.addEventListener('change', function(e) {
                if (!localStorage.getItem('theme')) {
                    if (e.matches) {
                        body.setAttribute('data-theme', 'dark');
                    } else {
                        body.removeAttribute('data-theme');
                    }
                    syncUtterancesTheme(e.matches);
                }
            });

            // Sidebar toggle (desktop + mobile)
            const sidebarToggle = document.querySelector('.sidebar-toggle');
            const sidebar = document.querySelector('.sidebar');
            const sidebarOverlay = document.querySelector('.sidebar-overlay');

            if (sidebarToggle && sidebar) {
                // Helper function to detect mobile
                const isMobile = () => window.innerWidth < 768;

                // Function to handle sidebar opening
                const openSidebar = () => {
                    sidebar.classList.add('active');
                    if (sidebarOverlay) {
                        sidebarOverlay.classList.add('active');
                        // Ensure overlay doesn't block page interaction when closed
                        sidebarOverlay.style.pointerEvents = 'auto';
                    }
                };

                // Function to handle sidebar closing
                const closeSidebar = () => {
                    sidebar.classList.remove('active');
                    if (sidebarOverlay) {
                        sidebarOverlay.classList.remove('active');
                        // Remove overlay when not needed to avoid blocking page
                        sidebarOverlay.style.pointerEvents = 'none';
                    }
                };

                // Restore saved collapse state for desktop
                if (!isMobile() && localStorage.getItem('sidebar-collapsed') === 'true') {
                    document.body.classList.add('sidebar-collapsed');
                }

                sidebarToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();

                    if (isMobile()) {
                        // Mobile: overlay drawer behavior
                        if (sidebar.classList.contains('active')) {
                            closeSidebar();
                        } else {
                            openSidebar();
                        }
                    } else {
                        // Desktop: collapse/expand with body offset
                        document.body.classList.toggle('sidebar-collapsed');
                        localStorage.setItem('sidebar-collapsed',
                            document.body.classList.contains('sidebar-collapsed'));
                    }
                });

                // Close sidebar when clicking on overlay
                if (sidebarOverlay) {
                    sidebarOverlay.addEventListener('click', function(e) {
                        e.preventDefault();
                        closeSidebar();
                    });

                    // Prevent scroll on overlay
                    sidebarOverlay.addEventListener('touchmove', function(e) {
                        e.preventDefault();
                    }, { passive: false });
                }

                // Handle resize events to ensure proper behavior when switching between mobile/desktop
                let resizeTimeout;
                window.addEventListener('resize', function() {
                    // Clear any existing timeout
                    clearTimeout(resizeTimeout);

                    // Use timeout to handle resize efficiently
                    resizeTimeout = setTimeout(() => {
                        if (!isMobile()) {
                            // On desktop view, ensure mobile classes are removed
                            sidebar.classList.remove('active');
                            if (sidebarOverlay) {
                                sidebarOverlay.classList.remove('active');
                                sidebarOverlay.style.pointerEvents = 'none';
                            }
                        }
                    }, 100);
                });

                // Close sidebar on orientation change (important for mobile Safari)
                window.addEventListener('orientationchange', function() {
                    setTimeout(() => {
                        if (!isMobile()) {
                            sidebar.classList.remove('active');
                            if (sidebarOverlay) {
                                sidebarOverlay.classList.remove('active');
                                sidebarOverlay.style.pointerEvents = 'none';
                            }
                        }
                    }, 100);
                });

                // Close sidebar when clicking anywhere outside of it (on mobile)
                document.addEventListener('click', function(e) {
                    // Only handle outside clicks on mobile when sidebar is active
                    if (isMobile() &&
                        sidebar.classList.contains('active') &&
                        !sidebar.contains(e.target) &&
                        e.target !== sidebarToggle) {
                        closeSidebar();
                    }
                });
            }

            // Search functionality
            const searchInput = document.getElementById('search-input');
            const searchButton = document.getElementById('search-button');
            const searchResults = document.getElementById('search-results');
            const searchSuggestions = document.getElementById('search-suggestions');
            const searchTypeRadios = document.querySelectorAll('input[name="search-type"]');

            if (searchInput && searchButton) {
                let searchData = null;

                // Load search data
                async function loadSearchData() {
                    try {
                        const response = await fetch('./assets/js/search-data.json');
                        if (response.ok) {
                            searchData = await response.json();
                        } else {
                            console.error('Failed to load search data:', response.status);
                        }
                    } catch (error) {
                        console.error('Error loading search data:', error);
                    }
                }

                // Initialize search data
                loadSearchData();

                // Debounce function to limit search calls
                function debounce(func, wait) {
                    let timeout;
                    return function executedFunction(...args) {
                        const later = () => {
                            clearTimeout(timeout);
                            func(...args);
                        };
                        clearTimeout(timeout);
                        timeout = setTimeout(later, wait);
                    };
                }

                // Get selected search type
                function getSelectedSearchType() {
                    const selectedRadio = document.querySelector('input[name="search-type"]:checked');
                    return selectedRadio ? selectedRadio.value : 'all';
                }

                // Perform search
                function performSearch(query) {
                    if (!searchData || !query.trim()) {
                        searchResults.innerHTML = '';
                        searchSuggestions.innerHTML = '';
                        return;
                    }

                    const queryTerms = query.toLowerCase().split(/\s+/).filter(term => term.length > 0);
                    const searchType = getSelectedSearchType();

                    if (queryTerms.length === 0) {
                        searchResults.innerHTML = '';
                        return;
                    }

                    const results = [];

                    // Search through articles
                    searchData.articles.forEach(article => {
                        let score = 0;
                        let snippet = '';

                        // Get content based on search type
                        const lowerTitle = article.title.toLowerCase();
                        const lowerContent = article.content.toLowerCase();
                        const lowerTags = article.tags.join(' ').toLowerCase();

                        queryTerms.forEach(term => {
                            switch(searchType) {
                                case 'title':
                                    // Only title matches count
                                    if (lowerTitle.includes(term)) {
                                        score += 10;
                                    }
                                    break;
                                case 'content':
                                    // Only content matches count (fixed to exclude title matches)
                                    if (lowerContent.includes(term)) {
                                        score += 1;
                                    }
                                    break;
                                case 'all':
                                default:
                                    // Both title and content matches count
                                    if (lowerTitle.includes(term)) {
                                        score += 10;
                                    }
                                    if (lowerContent.includes(term)) {
                                        score += 1;
                                    }
                                    // Tag matches get medium-high score
                                    if (lowerTags.includes(term)) {
                                        score += 5;
                                    }
                                    break;
                            }
                        });

                        if (score > 0) {
                            // Generate snippet based on search type
                            let content = '';

                            if (searchType === 'title') {
                                // For title-only search, show title content
                                content = article.title.substring(0, 200);
                            } else if (searchType === 'content') {
                                // For content-only search, show content excerpt
                                content = article.content.substring(0, 200);
                            } else {
                                // For all search, show content with title as context
                                content = article.content.substring(0, 200);
                            }

                            // Find first occurrence of query term in content for snippet
                            queryTerms.forEach(term => {
                                let searchIn = content.toLowerCase();
                                if (searchType === 'title') {
                                    searchIn = lowerTitle;
                                } else if (searchType === 'content') {
                                    searchIn = lowerContent;
                                }

                                const index = searchIn.indexOf(term);
                                if (index !== -1) {
                                    // Expand snippet around the match
                                    let start, end;
                                    if (searchType === 'title') {
                                        start = Math.max(0, index - 15);
                                        end = Math.min(content.length, index + term.length + 35);
                                    } else {
                                        start = Math.max(0, index - 30);
                                        end = Math.min(content.length, index + term.length + 70);
                                    }

                                    content = (start > 0 ? '...' : '') +
                                              content.substring(start, end) +
                                              (end < (searchType === 'title' ? article.title.length : article.content.length) ? '...' : '');

                                    // Highlight the term in the snippet
                                    const searchContent = searchType === 'title' ? article.title : article.content;
                                    const adjustedIndex = searchType === 'title' ?
                                        Math.min(index, article.title.length - 1) :
                                        Math.min(index, article.content.length - 1);

                                    content = content.replace(
                                        new RegExp(`(${escapeRegExp(term)})`, 'gi'),
                                        '<mark>$1</mark>'
                                    );
                                }
                            });

                            results.push({
                                article: article,
                                score: score,
                                snippet: content
                            });
                        }
                    });

                    // Sort results by score
                    results.sort((a, b) => b.score - a.score);

                    // Display results
                    displaySearchResults(results);
                }

                // Display search results
                function displaySearchResults(results) {
                    if (results.length === 0) {
                        searchResults.innerHTML = '<p class="no-results">æœªæ‰¾åˆ°åŒ¹é…çš„æ–‡ç« </p>';
                        return;
                    }

                    const resultsHTML = results.map(result => `
                        <div class="search-result-item">
                            <h3 class="search-result-title">
                                <a href="./${result.article.slug}.html">${highlightQueryTerms(result.article.title, document.querySelector('#search-input').value)}</a>
                            </h3>
                            <div class="search-result-meta">
                                ${result.article.tags.map(tag => `<span class="tag">#${tag}</span>`).join('')}
                            </div>
                            <p class="search-result-excerpt">${result.snippet}</p>
                        </div>
                    `).join('');

                    searchResults.innerHTML = resultsHTML;
                }

                // Highlight query terms in text
                function highlightQueryTerms(text, query) {
                    if (!query.trim()) return text;

                    const queryTerms = query.split(/\s+/).filter(term => term.length > 0);
                    let highlightedText = text;

                    queryTerms.forEach(term => {
                        const regex = new RegExp(`(${escapeRegExp(term)})`, 'gi');
                        highlightedText = highlightedText.replace(regex, '<mark>$1</mark>');
                    });

                    return highlightedText;
                }

                // Escape special regex characters
                function escapeRegExp(string) {
                    return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                }

                // Event listener for search button
                searchButton.addEventListener('click', function() {
                    const query = searchInput.value;
                    performSearch(query);
                });

                // Event listener for Enter key
                searchInput.addEventListener('keypress', function(event) {
                    if (event.key === 'Enter') {
                        const query = searchInput.value;
                        performSearch(query);
                    }
                });

                // Add debounced input handler for live search (optional)
                const debouncedSearch = debounce(function() {
                    const query = searchInput.value;
                    performSearch(query);
                }, 300);

                searchInput.addEventListener('input', debouncedSearch);

                // Add event listeners for search type radios
                searchTypeRadios.forEach(radio => {
                    radio.addEventListener('change', function() {
                        const query = searchInput.value;
                        if (query.trim()) {
                            performSearch(query);
                        }
                    });
                });
            }
        });
    </script>
</body>
</html>